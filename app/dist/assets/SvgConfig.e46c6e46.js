import{u as A,r as i,o as H,i as N,b as d,e as c,d as o,D as k,E as w,F as p,f as x,t as S,g as V}from"./index.1de81d9c.js";import{S as W,a as D}from"./SVGView.6581aa3d.js";import{h as G}from"./toast.1c03bdcb.js";import{_ as q}from"./Loader.5f66cc62.js";const F={class:"modal fade",id:"modal-associate",tabindex:"-1"},I={class:"modal-dialog"},U={class:"modal-content"},z=o("div",{class:"modal-header"},"Associar Regi\xE3o",-1),P={class:"modal-body"},j={class:"bg-white border p-3 container text-center"},J=["innerHTML"],K={class:"mt-3"},Q=o("label",{for:"associate-option",class:"form-label"},"Associar \xE0:",-1),X=o("option",{value:"",disabled:""},"Selecione uma op\xE7\xE3o",-1),Y=["value"],Z=o("option",{value:"",disabled:""},"Selecione uma op\xE7\xE3o",-1),ee=["value"],te=o("button",{class:"btn btn-secondary","data-bs-dismiss":"modal"}," Cancelar ",-1),se={class:"container mt-5 text-center"},ae=o("h2",null,"Configurar SVG",-1),de={__name:"SvgConfig",setup(oe){const C=A(),g=new W,v=i(!1),f=i(null),$=i(null),r=i(C.params.id),e=i(null),u=i(null),h=i([]),B=async()=>{if(!r.value)return;const t=await g.options(r.value);h.value=t.data||[]},y=i([]),L=async()=>{if(!r.value)return;const t=await g.variables(r.value);y.value=t.data||[]},m=(t,a=!1)=>{t.style.stroke=a?"yellow":null,t.style.strokeWidth=a?"0.5px":null},b=async()=>{if(!r.value)return;v.value.loaderOn();const t=await g.get(r.value);f.value=t.data,v.value.loaderOff()},O=async()=>{if(!e.value)return;v.value.loaderOn(),e.value.setAttribute("data-type",e.value.kind),e.value.setAttribute("data-value",u.value||""),e.value.kind==="text"&&(e.value.textContent=u.value||"");const t=e.value.style.stroke,a=e.value.style.strokeWidth;m(e.value,!1);const n=document.querySelector("#uploaded-svg");if(n){f.value.content=n.outerHTML;const l=await g.update(r.value,f.value);l.success&&(G(l,"Regi\xE3o atualizada e salva com sucesso"),await b())}e.value.style.stroke=t,e.value.style.strokeWidth=a,E(),v.value.loaderOff()},T=()=>{const t=document.querySelector("#uploaded-svg");!t||t.addEventListener("dblclick",a=>{if(a.target.tagName.toLowerCase()==="svg")return;e.value&&m(e.value,!1),e.value=a.target,["text","tspan","textpath","title","desc"].includes(a.target.tagName.toLowerCase())?e.value.kind="text":e.value.kind="pin",m(a.target,!0);const l=document.getElementById("modal-associate");l&&new bootstrap.Modal(l).show()})},E=()=>{e.value&&m(e.value,!1),e.value=null};H(async()=>{await b(),await B(),await L(),N(()=>{T()})});const M=(t,a=200,n=100)=>{if(!t)return"";const l=t.getBBox(),s=5,R=`${l.x-s} ${l.y-s} ${l.width+2*s} ${l.height+2*s}`,_=t.cloneNode(!0);return _.style.stroke="none",_.style.strokeWidth="0",`<svg width="${a}" height="${n}" viewBox="${R}" xmlns="http://www.w3.org/2000/svg">
            ${_.outerHTML}
          </svg>`};return(t,a)=>{var n,l;return d(),c(p,null,[o("div",F,[o("div",I,[o("div",U,[z,o("div",P,[o("div",j,[o("div",{innerHTML:M(e.value)},null,8,J)]),o("div",K,[Q,((n=e.value)==null?void 0:n.kind)==="text"?k((d(),c("select",{key:0,id:"associate-option",class:"form-select","onUpdate:modelValue":a[0]||(a[0]=s=>u.value=s)},[X,(d(!0),c(p,null,x(y.value,s=>(d(),c("option",{key:s.key,value:s.key},S(s.label),9,Y))),128))],512)),[[w,u.value]]):k((d(),c("select",{key:1,id:"associate-option",class:"form-select","onUpdate:modelValue":a[1]||(a[1]=s=>u.value=s)},[Z,(d(!0),c(p,null,x(h.value,s=>(d(),c("option",{key:s.value,value:s.value},S(s.label),9,ee))),128))],512)),[[w,u.value]])])]),o("div",{class:"modal-footer"},[te,o("button",{class:"btn btn-danger","data-bs-dismiss":"modal",onClick:O}," Confirmar ")])])])]),V(q,{ref_key:"loader",ref:v},null,512),o("div",se,[ae,V(D,{ref_key:"svgView",ref:$,svg:(l=f.value)==null?void 0:l.content},null,8,["svg"])])],64)}}};export{de as default};
