import{B as R,u as K,A as x,q as B,r as w,o as L,a as U,b as n,e as i,g as p,w as O,d as e,D as h,J as g,n as c,m as l,h as d,F as A,f as T,E as j,t as I}from"./index.25e36820.js";import{r as _,b,c as J,d as P,u as G}from"./index.8fb258bd.js";import{h as H}from"./toast.4464608c.js";import{_ as $}from"./PinSelect.d91a3b27.js";const Q={class:"content"},W={class:"mb-3"},X=e("label",{class:"form-label"},"Nome",-1),Y={key:0,class:"invalid-feedback"},Z={class:"mb-3"},ee=e("label",{class:"form-label"},"Agitador",-1),se={key:0,class:"invalid-feedback"},ae={class:"mb-3"},te=e("label",{class:"form-label"},"Bomba",-1),oe={key:0,class:"invalid-feedback"},le={class:"mb-3"},ne=e("label",{class:"form-label"},"Balan\xE7a",-1),ie={key:0,class:"invalid-feedback"},re={class:"mb-3"},ce=e("label",{class:"form-label"},"Peso m\xE1ximo da cuba (kg)",-1),de={key:0,class:"invalid-feedback"},_e={class:"mb-3"},ue=e("label",{class:"form-label"},"Fra\xE7\xE3o de peso da cuba",-1),me={key:0,class:"invalid-feedback"},pe={class:"flex"},be=e("label",{class:"form-label me-3"},"Tanques",-1),ve={class:"col-7"},he=["onUpdate:modelValue"],ke=e("option",{value:""},"Selecione um tanque",-1),fe=["value"],we={key:0,class:"invalid-feedback"},ge={class:"col-auto d-flex align-items-start"},$e=["onClick"],Ue={__name:"KitchenForm",setup(Ve){const q=R(),F=K(),k=new x("/kitchens"),s=B({name:"",shaker_pin_id:null,pump_pin_id:null,scale_pin_id:null,max_bowl_weight:null,bowl_weight_fraction:null,tanks:[]}),u=w(null),N=async()=>{const r=await k.get(u.value);Object.assign(s,r.data)},S=new x("/product-tanks"),V=w([]),z=async()=>{const r=await S.getList();V.value=r.data.items.map(a=>({label:`${a.name} - ${a.product.name}`,value:a.id}))||[]};L(async()=>{u.value=F.params.id,u.value&&await N(u.value),await z()});const D=B({name:{required:_},shaker_pin_id:{required:_,minValue:b(1)},pump_pin_id:{required:_,minValue:b(1)},scale_pin_id:{required:_,minValue:b(1)},max_bowl_weight:{required:_,minValue:b(0)},bowl_weight_fraction:{required:_,minValue:b(0),maxValue:J(1)},tanks:{$each:P.forEach({product_tank_id:{required:_}})}}),t=G(D,s),y=r=>{H(r,"Cozinha salva com sucesso"),r.success&&q.push({name:"kitchens"})},f=w(!1),E=async()=>{t.value.$touch(),f.value=!0,!t.value.$invalid&&(u.value?y(await k.update(u.value,s)):y(await k.save(s)))};return(r,a)=>{const C=U("mdicon"),M=U("BaseBlock");return n(),i("div",Q,[p(M,{title:"Cozinha"},{default:O(()=>[e("div",W,[X,h(e("input",{"onUpdate:modelValue":a[0]||(a[0]=o=>s.name=o),type:"text",class:c(["form-control",{"is-invalid":l(t).name.$error}])},null,2),[[g,s.name]]),l(t).name.$error?(n(),i("div",Y,"Campo necess\xE1rio")):d("",!0)]),e("div",Z,[ee,p($,{modelValue:s.shaker_pin_id,"onUpdate:modelValue":a[1]||(a[1]=o=>s.shaker_pin_id=o),class:c({"is-invalid":l(t).shaker_pin_id.$error})},null,8,["modelValue","class"]),l(t).shaker_pin_id.$error?(n(),i("div",se,"Campo necess\xE1rio")):d("",!0)]),e("div",ae,[te,p($,{modelValue:s.pump_pin_id,"onUpdate:modelValue":a[2]||(a[2]=o=>s.pump_pin_id=o),class:c({"is-invalid":l(t).pump_pin_id.$error})},null,8,["modelValue","class"]),l(t).pump_pin_id.$error?(n(),i("div",oe,"Campo necess\xE1rio")):d("",!0)]),e("div",le,[ne,p($,{modelValue:s.scale_pin_id,"onUpdate:modelValue":a[3]||(a[3]=o=>s.scale_pin_id=o),class:c({"is-invalid":l(t).scale_pin_id.$error})},null,8,["modelValue","class"]),l(t).scale_pin_id.$error?(n(),i("div",ie,"Campo necess\xE1rio")):d("",!0)]),e("div",re,[ce,h(e("input",{"onUpdate:modelValue":a[4]||(a[4]=o=>s.max_bowl_weight=o),type:"number",class:c(["form-control",{"is-invalid":l(t).max_bowl_weight.$error}])},null,2),[[g,s.max_bowl_weight]]),l(t).max_bowl_weight.$error?(n(),i("div",de," Campo obrigat\xF3rio e \u2265 0 ")):d("",!0)]),e("div",_e,[ue,h(e("input",{"onUpdate:modelValue":a[5]||(a[5]=o=>s.bowl_weight_fraction=o),type:"number",step:"0.01",class:c(["form-control",{"is-invalid":l(t).bowl_weight_fraction.$error}])},null,2),[[g,s.bowl_weight_fraction]]),l(t).bowl_weight_fraction.$error?(n(),i("div",me," Campo obrigat\xF3rio (0 \u2264 valor \u2264 1) ")):d("",!0)]),e("div",pe,[be,e("button",{type:"button",class:"btn btn-lg btn-success mb-2",onClick:a[6]||(a[6]=o=>s.tanks.push({product_tank_id:null}))},[p(C,{name:"plus"})])]),(n(!0),i(A,null,T(s.tanks,(o,v)=>(n(),i("div",{key:v,class:"row g-2 align-items-start mb-2"},[e("div",ve,[h(e("select",{"onUpdate:modelValue":m=>o.product_tank_id=m,class:c(["form-select",{"is-invalid":l(t).tanks.$each.$response.$data[v].product_tank_id.$error&&f.value}])},[ke,(n(!0),i(A,null,T(V.value,m=>(n(),i("option",{key:m.value,value:m.value},I(m.label),9,fe))),128))],10,he),[[j,o.product_tank_id]]),l(t).tanks.$each.$response.$data[v].product_tank_id.$error&&f.value?(n(),i("div",we," Campo necess\xE1rio ")):d("",!0)]),e("div",ge,[e("button",{type:"button",class:"btn btn-lg btn-danger",onClick:m=>s.tanks.splice(v,1)},[p(C,{name:"close"})],8,$e)])]))),128)),e("button",{onClick:E,class:"btn btn-primary mb-4 btn-lg"},"Salvar")]),_:1})])}}};export{Ue as default};
