import{s as M,b as d,e as c,H as R,B as j,u as K,A as U,q as I,r as C,o as L,a as A,g as b,w as O,d as t,D as N,J as F,n as f,m as r,h as v,F as z,f as q,E as H,t as J}from"./index.a968d502.js";import{r as h,b as w,d as W,u as G}from"./index.b238c132.js";import{h as Q}from"./toast.153b1529.js";import{_ as B}from"./PinSelect.90166d75.js";const X=["value","inputmode"],Y={__name:"NumericInput",props:{modelValue:{type:[String,Number],default:""},type:{type:String,default:"decimal"},min:Number,max:Number},emits:["update:modelValue"],setup(D,{emit:m}){const o=D,g=M(()=>o.modelValue!==null&&o.modelValue!==void 0?String(o.modelValue):""),a=e=>{if(e==null)return"";if(e=String(e).replace(",","."),o.type==="integer")return e.replace(/[^0-9]/g,"");e=e.replace(/[^0-9.]/g,"");const u=e.split(".");return u.length>2&&(e=u.shift()+"."+u.join("")),e},p=e=>{var s;if((e.inputType||"").startsWith("delete"))return;const n=(s=e.data)!=null?s:"";if(o.type==="integer"){/^[0-9]+$/.test(n)||e.preventDefault();return}/^[0-9.,]+$/.test(n)||e.preventDefault()},$=e=>{let u=a(e.target.value);if(u===""){m("update:modelValue",null);return}let n;if(o.type==="integer"){if(n=parseInt(u,10),Number.isNaN(n)){m("update:modelValue",null);return}}else if(n=parseFloat(u),Number.isNaN(n)){m("update:modelValue",null);return}o.min!==void 0&&n<o.min&&(n=o.min),o.max!==void 0&&n>o.max&&(n=o.max),m("update:modelValue",n)},y=e=>{e.preventDefault();const u=e.clipboardData.getData("text"),n=a(u);if(n===""){m("update:modelValue",null);return}const s=o.type==="integer"?parseInt(n,10):parseFloat(n);if(Number.isNaN(s)){m("update:modelValue",null);return}m("update:modelValue",s)};return(e,u)=>(d(),c("input",R(e.$attrs,{value:g.value,type:"text",inputmode:o.type==="integer"?"numeric":"decimal",class:"form-control",onBeforeinput:p,onInput:$,onPaste:y}),null,16,X))}},Z={class:"content"},ee={class:"mb-3"},te=t("label",{class:"form-label"},"Nome",-1),ae={key:0,class:"invalid-feedback"},se={class:"mb-3"},ne=t("label",{class:"form-label"},"Agitador",-1),le={key:0,class:"invalid-feedback"},oe={class:"mb-3"},ie=t("label",{class:"form-label"},"Bomba",-1),re={key:0,class:"invalid-feedback"},ue={class:"mb-3"},de=t("label",{class:"form-label"},"Balan\xE7a",-1),ce={key:0,class:"invalid-feedback"},me={class:"mb-3"},pe=t("label",{class:"form-label"},"Peso m\xE1ximo da cuba (kg)",-1),_e={key:0,class:"invalid-feedback"},be={class:"mb-3"},fe=t("label",{class:"form-label"},"Fra\xE7\xE3o de peso da cuba",-1),ve={key:0,class:"invalid-feedback"},he={class:"flex"},ke=t("label",{class:"form-label me-3"},"Tanques",-1),ge={class:"col-7"},Ve=["onUpdate:modelValue"],we=t("option",{value:""},"Selecione um tanque",-1),$e=["value"],ye={key:0,class:"invalid-feedback"},xe={class:"col-auto d-flex align-items-start"},Ce=["onClick"],Te={__name:"KitchenForm",setup(D){const m=j(),o=K(),g=new U("/kitchens"),a=I({name:"",shaker_pin_id:null,pump_pin_id:null,scale_pin_id:null,max_bowl_weight:null,bowl_weight_fraction:null,tanks:[]}),p=C(null),$=async()=>{const _=await g.get(p.value);Object.assign(a,_.data)},y=new U("/product-tanks"),e=C([]),u=async()=>{const _=await y.getList();e.value=_.data.items.map(l=>({label:`${l.name} - ${l.product.name}`,value:l.id}))||[]};L(async()=>{p.value=o.params.id,p.value&&await $(p.value),await u()});const n=I({name:{required:h},shaker_pin_id:{required:h,minValue:w(1)},pump_pin_id:{required:h,minValue:w(1)},scale_pin_id:{required:h,minValue:w(1)},max_bowl_weight:{required:h,minValue:w(0)},bowl_weight_fraction:{required:h},tanks:{$each:W.forEach({product_tank_id:{required:h}})}}),s=G(n,a),S=_=>{Q(_,"Cozinha salva com sucesso"),_.success&&m.push({name:"kitchens"})},x=C(!1),P=async()=>{s.value.$touch(),x.value=!0,!s.value.$invalid&&(p.value?S(await g.update(p.value,a)):S(await g.save(a)))};return(_,l)=>{const T=A("mdicon"),E=A("BaseBlock");return d(),c("div",Z,[b(E,{title:"Cozinha"},{default:O(()=>[t("div",ee,[te,N(t("input",{"onUpdate:modelValue":l[0]||(l[0]=i=>a.name=i),type:"text",class:f(["form-control",{"is-invalid":r(s).name.$error}])},null,2),[[F,a.name]]),r(s).name.$error?(d(),c("div",ae,"Campo necess\xE1rio")):v("",!0)]),t("div",se,[ne,b(B,{modelValue:a.shaker_pin_id,"onUpdate:modelValue":l[1]||(l[1]=i=>a.shaker_pin_id=i),class:f({"is-invalid":r(s).shaker_pin_id.$error})},null,8,["modelValue","class"]),r(s).shaker_pin_id.$error?(d(),c("div",le,"Campo necess\xE1rio")):v("",!0)]),t("div",oe,[ie,b(B,{modelValue:a.pump_pin_id,"onUpdate:modelValue":l[2]||(l[2]=i=>a.pump_pin_id=i),class:f({"is-invalid":r(s).pump_pin_id.$error})},null,8,["modelValue","class"]),r(s).pump_pin_id.$error?(d(),c("div",re,"Campo necess\xE1rio")):v("",!0)]),t("div",ue,[de,b(B,{modelValue:a.scale_pin_id,"onUpdate:modelValue":l[3]||(l[3]=i=>a.scale_pin_id=i),class:f({"is-invalid":r(s).scale_pin_id.$error})},null,8,["modelValue","class"]),r(s).scale_pin_id.$error?(d(),c("div",ce,"Campo necess\xE1rio")):v("",!0)]),t("div",me,[pe,N(t("input",{"onUpdate:modelValue":l[4]||(l[4]=i=>a.max_bowl_weight=i),type:"number",class:f(["form-control",{"is-invalid":r(s).max_bowl_weight.$error}])},null,2),[[F,a.max_bowl_weight]]),r(s).max_bowl_weight.$error?(d(),c("div",_e," Campo obrigat\xF3rio e \u2265 0 ")):v("",!0)]),t("div",be,[fe,b(Y,{modelValue:a.bowl_weight_fraction,"onUpdate:modelValue":l[5]||(l[5]=i=>a.bowl_weight_fraction=i),type:"integer",min:0,max:100,step:.01,class:f({"is-invalid":r(s).bowl_weight_fraction.$error})},null,8,["modelValue","class"]),r(s).bowl_weight_fraction.$error?(d(),c("div",ve," Campo obrigat\xF3rio (0 \u2264 valor \u2264 100) ")):v("",!0)]),t("div",he,[ke,t("button",{type:"button",class:"btn btn-lg btn-success mb-2",onClick:l[6]||(l[6]=i=>a.tanks.push({product_tank_id:null}))},[b(T,{name:"plus"})])]),(d(!0),c(z,null,q(a.tanks,(i,V)=>(d(),c("div",{key:V,class:"row g-2 align-items-start mb-2"},[t("div",ge,[N(t("select",{"onUpdate:modelValue":k=>i.product_tank_id=k,class:f(["form-select",{"is-invalid":r(s).tanks.$each.$response.$data[V].product_tank_id.$error&&x.value}])},[we,(d(!0),c(z,null,q(e.value,k=>(d(),c("option",{key:k.value,value:k.value},J(k.label),9,$e))),128))],10,Ve),[[H,i.product_tank_id]]),r(s).tanks.$each.$response.$data[V].product_tank_id.$error&&x.value?(d(),c("div",ye," Campo necess\xE1rio ")):v("",!0)]),t("div",xe,[t("button",{type:"button",class:"btn btn-lg btn-danger",onClick:k=>a.tanks.splice(V,1)},[b(T,{name:"close"})],8,Ce)])]))),128)),t("button",{onClick:P,class:"btn btn-primary mb-4 btn-lg"},"Salvar")]),_:1})])}}};export{Te as default};
