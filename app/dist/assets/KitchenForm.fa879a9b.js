import{B as R,u as K,A as C,q as x,r as f,o as L,a as B,b as n,e as i,g as d,w as O,d as e,D as w,J as U,n as c,m as l,h as _,F as A,f as T,E as j,t as I}from"./index.1de81d9c.js";import{r as u,b as v,d as J,u as P}from"./index.2f424ca5.js";import{h as G}from"./toast.1c03bdcb.js";import{_ as g}from"./PinSelect.7fe157fe.js";import{_ as H}from"./NumericInput.efd2cf3f.js";const Q={class:"content"},W={class:"mb-3"},X=e("label",{class:"form-label"},"Nome",-1),Y={key:0,class:"invalid-feedback"},Z={class:"mb-3"},ee=e("label",{class:"form-label"},"Agitador",-1),se={key:0,class:"invalid-feedback"},ae={class:"mb-3"},te=e("label",{class:"form-label"},"Bomba",-1),oe={key:0,class:"invalid-feedback"},le={class:"mb-3"},ne=e("label",{class:"form-label"},"Balan\xE7a",-1),ie={key:0,class:"invalid-feedback"},re={class:"mb-3"},de=e("label",{class:"form-label"},"Peso m\xE1ximo da cuba (kg)",-1),ce={key:0,class:"invalid-feedback"},_e={class:"mb-3"},ue=e("label",{class:"form-label"},"Fra\xE7\xE3o de peso da cuba",-1),me={key:0,class:"invalid-feedback"},pe={class:"flex"},be=e("label",{class:"form-label me-3"},"Tanques",-1),ve={class:"col-7"},he=["onUpdate:modelValue"],ke=e("option",{value:""},"Selecione um tanque",-1),fe=["value"],we={key:0,class:"invalid-feedback"},ge={class:"col-auto d-flex align-items-start"},$e=["onClick"],Ae={__name:"KitchenForm",setup(Ve){const q=R(),F=K(),h=new C("/kitchens"),s=x({name:"",shaker_pin_id:null,pump_pin_id:null,scale_pin_id:null,max_bowl_weight:null,bowl_weight_fraction:null,tanks:[]}),m=f(null),N=async()=>{const r=await h.get(m.value);Object.assign(s,r.data)},S=new C("/product-tanks"),$=f([]),z=async()=>{const r=await S.getList();$.value=r.data.items.map(a=>({label:`${a.name} - ${a.product.name}`,value:a.id}))||[]};L(async()=>{m.value=F.params.id,m.value&&await N(m.value),await z()});const D=x({name:{required:u},shaker_pin_id:{required:u,minValue:v(1)},pump_pin_id:{required:u,minValue:v(1)},scale_pin_id:{required:u,minValue:v(1)},max_bowl_weight:{required:u,minValue:v(0)},bowl_weight_fraction:{required:u},tanks:{$each:J.forEach({product_tank_id:{required:u}})}}),t=P(D,s),V=r=>{G(r,"Cozinha salva com sucesso"),r.success&&q.push({name:"kitchens"})},k=f(!1),E=async()=>{t.value.$touch(),k.value=!0,!t.value.$invalid&&(m.value?V(await h.update(m.value,s)):V(await h.save(s)))};return(r,a)=>{const y=B("mdicon"),M=B("BaseBlock");return n(),i("div",Q,[d(M,{title:"Cozinha"},{default:O(()=>[e("div",W,[X,w(e("input",{"onUpdate:modelValue":a[0]||(a[0]=o=>s.name=o),type:"text",class:c(["form-control",{"is-invalid":l(t).name.$error}])},null,2),[[U,s.name]]),l(t).name.$error?(n(),i("div",Y,"Campo necess\xE1rio")):_("",!0)]),e("div",Z,[ee,d(g,{modelValue:s.shaker_pin_id,"onUpdate:modelValue":a[1]||(a[1]=o=>s.shaker_pin_id=o),class:c({"is-invalid":l(t).shaker_pin_id.$error})},null,8,["modelValue","class"]),l(t).shaker_pin_id.$error?(n(),i("div",se,"Campo necess\xE1rio")):_("",!0)]),e("div",ae,[te,d(g,{modelValue:s.pump_pin_id,"onUpdate:modelValue":a[2]||(a[2]=o=>s.pump_pin_id=o),class:c({"is-invalid":l(t).pump_pin_id.$error})},null,8,["modelValue","class"]),l(t).pump_pin_id.$error?(n(),i("div",oe,"Campo necess\xE1rio")):_("",!0)]),e("div",le,[ne,d(g,{modelValue:s.scale_pin_id,"onUpdate:modelValue":a[3]||(a[3]=o=>s.scale_pin_id=o),class:c({"is-invalid":l(t).scale_pin_id.$error})},null,8,["modelValue","class"]),l(t).scale_pin_id.$error?(n(),i("div",ie,"Campo necess\xE1rio")):_("",!0)]),e("div",re,[de,w(e("input",{"onUpdate:modelValue":a[4]||(a[4]=o=>s.max_bowl_weight=o),type:"number",class:c(["form-control",{"is-invalid":l(t).max_bowl_weight.$error}])},null,2),[[U,s.max_bowl_weight]]),l(t).max_bowl_weight.$error?(n(),i("div",ce," Campo obrigat\xF3rio e \u2265 0 ")):_("",!0)]),e("div",_e,[ue,d(H,{modelValue:s.bowl_weight_fraction,"onUpdate:modelValue":a[5]||(a[5]=o=>s.bowl_weight_fraction=o),type:"integer",min:0,max:100,step:.01,class:c({"is-invalid":l(t).bowl_weight_fraction.$error})},null,8,["modelValue","class"]),l(t).bowl_weight_fraction.$error?(n(),i("div",me," Campo obrigat\xF3rio (0 \u2264 valor \u2264 100) ")):_("",!0)]),e("div",pe,[be,e("button",{type:"button",class:"btn btn-lg btn-success mb-2",onClick:a[6]||(a[6]=o=>s.tanks.push({product_tank_id:null}))},[d(y,{name:"plus"})])]),(n(!0),i(A,null,T(s.tanks,(o,b)=>(n(),i("div",{key:b,class:"row g-2 align-items-start mb-2"},[e("div",ve,[w(e("select",{"onUpdate:modelValue":p=>o.product_tank_id=p,class:c(["form-select",{"is-invalid":l(t).tanks.$each.$response.$data[b].product_tank_id.$error&&k.value}])},[ke,(n(!0),i(A,null,T($.value,p=>(n(),i("option",{key:p.value,value:p.value},I(p.label),9,fe))),128))],10,he),[[j,o.product_tank_id]]),l(t).tanks.$each.$response.$data[b].product_tank_id.$error&&k.value?(n(),i("div",we," Campo necess\xE1rio ")):_("",!0)]),e("div",ge,[e("button",{type:"button",class:"btn btn-lg btn-danger",onClick:p=>s.tanks.splice(b,1)},[d(y,{name:"close"})],8,$e)])]))),128)),e("button",{onClick:E,class:"btn btn-primary mb-4 btn-lg"},"Salvar")]),_:1})])}}};export{Ae as default};
