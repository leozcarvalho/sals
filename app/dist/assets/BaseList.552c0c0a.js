import{r as p,s as k,b as c,e as f,d as o,n as N,F as O,f as E,t as T,k as M,v as h,x as $,y as I,c as z,w as j,h as y,z as J,i as Q,B as U,o as W,a as V,g as A,m as L,C as Y,D as Z,E as K,G as X}from"./index.0a935b94.js";import{h as ee}from"./toast.cd5fee6e.js";import{_ as te}from"./Loader.232eaff5.js";const se={class:"d-flex flex-md-row flex-column justify-content-center align-items-center mt-5"},ae={"aria-label":"Page navigation example"},ne={class:"pagination"},le=["onClick"],oe={__name:"Paginator",props:{perPage:{type:Number,default:10,description:"Items per page"},totalRows:{type:Number,default:50,description:"Total items"}},setup(t,{emit:l}){const s=t,e=p(1),n=k(()=>parseInt(Math.ceil(s.totalRows/s.perPage))),a=i=>{i>=1&&i<=n.value&&(e.value=i,l("changePage",i))},d=k(()=>Math.max(1,e.value-2)),r=k(()=>Math.min(n.value,e.value+2)),P=k(()=>{const i=[];for(let g=d.value;g<=r.value;g++)i.push(g);return d.value>2&&i.unshift("..."),d.value>1&&i.unshift(1),r.value<n.value-1&&i.push("..."),r.value<n.value&&i.push(n.value),i});return(i,g)=>(c(),f("div",se,[o("nav",ae,[o("ul",ne,[o("li",{class:N(["page-item",{disabled:e.value<=1}])},[o("a",{class:"page-link",onClick:g[0]||(g[0]=v=>a(e.value-1))},"Anterior")],2),(c(!0),f(O,null,E(P.value,v=>(c(),f("li",{key:v,class:N(["page-item",{active:v===e.value,disabled:v==="..."}])},[o("a",{class:"page-link",onClick:S=>v!=="..."&&a(v)},T(v),9,le)],2))),128)),o("li",{class:N(["page-item",{disabled:e.value>=n.value}])},[o("a",{class:"page-link",onClick:g[1]||(g[1]=v=>a(e.value+1))},"Pr\xF3xima")],2)])])]))}},re={show:"Show",entries:"entries",previous:"Previous",next:"Next",showing:"Showing",showingTo:"to",showingOf:"of",showingEntries:"entries"},ie="...";function q(t){for(const l in t)return!1;return!0}function de(t,l){const s=[],e=[];let n;if(s.push(1),t<=1)return s;for(let a=l-2;a<=l+2;a++)a<t&&a>1&&s.push(a);s.push(t);for(let a=0;a<s.length;a++)n&&(s[a]-n===2?e.push(n+1):s[a]-n!==1&&e.push(ie)),e.push(s[a]),n=s[a];return e}function ue(t,l={}){const s=[];let e;const n=t.length;return t=t.map(function(a,d){return a[0]==="-"?(s[d]=-1,a=a.substring(1)):s[d]=1,a}),function(a,d){for(e=0;e<n;e++){const r=t[e],P=l[r]?l[r](a.value[r]):a.value[r],i=l[r]?l[r](d.value[r]):d.value[r];if(P>i)return s[e];if(P<i)return-s[e]}return 0}}function ce(t,l){for(const s in l)t=t.filter(function(e){const n=e.value;for(const a in n)if(a===s){if(typeof l[s]=="function")return l[s](n[a]);if(l[s]===""||n[a]===l[s])return!0}return!1});return t}function fe(t,l,s,e){e=String(e).toLowerCase();for(const n in s)if(t.length===0||t.indexOf(n)!==-1){const a=String(s[n]).toLowerCase();for(const d in l)if(d===n&&typeof l[d]=="function"){const r=l[d](a,e,s);if(r===!0)return r}if(a.indexOf(e)>=0)return!0}return!1}const G=(t,l)=>{const s=t.__vccOpts||t;for(const[e,n]of l)s[e]=n;return s},ve={props:{dsData:{type:Array,default:()=>[]},dsFilterFields:{type:Object,default:()=>({})},dsSortby:{type:Array,default:()=>[]},dsSearchIn:{type:Array,default:()=>[]},dsSearchAs:{type:Object,default:()=>({})},dsSortAs:{type:Object,default:()=>({})}},emits:["update:dsData"],setup(t,{emit:l}){const s=p(1),e=p(""),n=p(10),a=p(re),d=p([]),r=m=>{e.value=m},P=async m=>{n.value=m,await Q(),s.value>F.value&&i(v.value[v.value.length-1])},i=m=>{s.value=m},g=k(()=>d.value.slice(B.value,R.value)),v=k(()=>de(F.value,s.value)),S=k(()=>d.value.length),F=k(()=>Math.ceil(S.value/n.value)),B=k(()=>(s.value-1)*n.value),R=k(()=>s.value*n.value);return M(S,(m,w)=>{i(1)}),M(()=>[t.dsData,e,t.dsSortby,t.dsFilterFields,t.dsSearchIn,t.dsSearchAs,t.dsSortAs],()=>{let m=[];!e.value&&!t.dsSortby.length&&q(t.dsFilterFields)?m=t.dsData.map((w,u)=>u):(m=t.dsData.map((w,u)=>({index:u,value:w})),q(t.dsFilterFields)||(m=ce(m,t.dsFilterFields)),e.value&&(m=m.filter(w=>fe(t.dsSearchIn,t.dsSearchAs,w.value,e.value))),t.dsSortby.length&&m.sort(ue(t.dsSortby,t.dsSortAs)),m=m.map(w=>w.index)),d.value=m,l("update:dsData",m.map(w=>t.dsData[w]))},{immediate:!0,deep:!0}),h("dsIndexes",d),h("search",r),h("showEntries",P),h("setActive",i),h("datasetI18n",a),h("dsData",k(()=>t.dsData)),h("dsRows",g),h("dsPages",v),h("dsResultsNumber",S),h("dsPagecount",F),h("dsFrom",B),h("dsTo",R),h("dsPage",s),{dsIndexes:d,dsShowEntries:n,dsResultsNumber:S,dsPage:s,dsPagecount:F,dsFrom:B,dsTo:R,dsRows:g,dsPages:v,search:r,showEntries:P,setActive:i}}};function me(t,l,s,e,n,a){return $(t.$slots,"default",{ds:{dsIndexes:e.dsIndexes,dsShowEntries:e.dsShowEntries,dsResultsNumber:e.dsResultsNumber,dsPage:e.dsPage,dsPagecount:e.dsPagecount,dsFrom:e.dsFrom,dsTo:e.dsTo,dsData:s.dsData,dsRows:e.dsRows,dsPages:e.dsPages,search:e.search,showEntries:e.showEntries,setActive:e.setActive}})}const ge=G(ve,[["render",me]]),he={props:{tag:{type:String,default:"div"}},setup(){const t=k(()=>{const l=[];for(let s=I("dsFrom").value;s<I("dsTo").value;s++)l.push(s);return l});return{dsData:I("dsData"),dsRows:I("dsRows"),indexes:t}}};function pe(t,l,s,e,n,a){return c(),z(J(s.tag),null,{default:j(()=>[(c(!0),f(O,null,E(e.dsRows,(d,r)=>$(t.$slots,"default",{row:e.dsData[d],rowIndex:d,index:e.indexes[r]})),256)),e.dsRows.length?y("",!0):$(t.$slots,"noDataFound",{key:0})]),_:3})}const be=G(he,[["render",pe]]),ye={key:0,class:"content"},ke={class:"d-flex justify-content-between mb-2"},we=["value"],_e=o("i",{class:"fa fa-plus"},null,-1),Pe=[_e],xe={key:0,class:"mb-3"},Se={class:"table-responsive"},Ce={class:"table table-striped"},De=["onClick"],$e={key:0},Fe={key:0},Ae={class:"btn-group"},Oe=["onClick"],Be=o("i",{class:"fa fa-pencil"},null,-1),Re=[Be],Ee=["onClick"],Ie=o("i",{class:"fa fa-trash"},null,-1),Ne=[Ie],Te=o("div",{class:"modal-header"},"Confirmar A\xE7\xE3o",-1),je=o("div",{class:"modal-body"},"Deseja realmente excluir este item?",-1),Le=o("button",{class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancelar",-1),Ge={__name:"BaseList",props:{api:{type:Object,required:!0},formPath:{type:String,default:""},cols:{type:Array,required:!0},title:{type:String,default:"Lista"},canCreate:{type:Boolean,default:!0},canEdit:{type:Boolean,default:!0},canDelete:{type:Boolean,default:!0},exportable:{type:Boolean,default:!1},canFilter:{type:Boolean,default:!1},filter:{type:Object,default:{}},canPaginate:{type:Boolean,default:!1},permission:{type:String,default:null}},emits:["update:filter","create","edit"],setup(t,{expose:l,emit:s}){const e=t,n=p(!1),a=p([]),d=p(0),r=p(e.filter.limit||10),P=p([5,10,25,50,100]),i=p(null),g=p(!1);U();const v=async()=>{var x,C;n.value.loaderOn();const u=await e.api.getList(e.filter);a.value=u.data.items||((x=u.data.data)==null?void 0:x.items)||[],d.value=u.data.count||((C=u.data.data)==null?void 0:C.count)||0,n.value.loaderOff()};l({refresh:v});const S=()=>{g.value=!g.value},F=u=>{!e.filter||(e.filter.skip=r.value*(u-1),s("update:filter",e.filter),v())},B=()=>{!e.filter||(e.filter.limit=r.value,e.filter.skip=0,s("update:filter",e.filter),v())},R=u=>{e.filter.sort_by=e.cols[u].field,e.filter.order_desc=!e.filter.order_desc,e.cols.forEach((x,C)=>{x.sort=C===u?e.filter.order_desc?"desc":"asc":""}),s("update:filter",e.filter),v()},m=async()=>{if(!i.value)return;const u=await e.api.delete(i.value);ee(u,"Item exclu\xEDdo com sucesso"),v()},w=async()=>{!e.exportable||await e.api.export(e.filter)};return W(()=>{v()}),(u,x)=>{const C=V("mdicon"),H=V("BaseBlock");return c(),f(O,null,[A(te,{ref_key:"loader",ref:n},null,512),e.permission===null||L(Y)(e.permission)?(c(),f("div",ye,[A(H,{title:t.title,"content-full":""},{default:j(()=>[o("div",ke,[o("div",null,[t.canFilter?(c(),f("button",{key:0,class:"btn btn-lg btn-primary",onClick:S},[A(C,{name:"filter"})])):y("",!0),t.canPaginate?Z((c(),f("select",{key:1,"onUpdate:modelValue":x[0]||(x[0]=D=>r.value=D),onChange:B,class:"form-select d-inline w-auto ms-2"},[(c(!0),f(O,null,E(P.value,D=>(c(),f("option",{key:D,value:D},T(D),9,we))),128))],544)),[[K,r.value]]):y("",!0)]),o("div",null,[$(u.$slots,"extra-actions"),t.canCreate?(c(),f("button",{key:0,class:"btn btn-lg btn-success",onClick:x[1]||(x[1]=D=>u.$emit("create"))},Pe)):y("",!0),t.exportable?(c(),f("button",{key:1,class:"btn btn-lg btn-success ms-2",onClick:w},[A(C,{name:"file-excel"})])):y("",!0)])]),g.value?(c(),f("div",xe,[$(u.$slots,"filter")])):y("",!0),A(L(ge),{"ds-data":a.value,"ds-sortby":e.filter.sort_by?[e.filter.sort_by]:[]},{default:j(({ds:D})=>[o("div",Se,[o("table",Ce,[o("thead",null,[o("tr",null,[(c(!0),f(O,null,E(t.cols,(b,_)=>(c(),f("th",{key:b.field,class:N(["sort",b.sort]),onClick:Me=>R(_)},T(b.name),11,De))),128)),t.canEdit||t.canDelete||u.$slots["row-actions"]?(c(),f("th",$e,"A\xE7\xF5es")):y("",!0)])]),A(L(be),{tag:"tbody",class:"fs-sm"},{default:j(({row:b})=>[o("tr",null,[(c(!0),f(O,null,E(t.cols,_=>(c(),f("td",{key:_.field},[$(u.$slots,`cell-${_.field}`,{row:b,value:b[_.field]},()=>[X(T(_.formatter?_.formatter(b[_.field],b):b[_.field]),1)])]))),128)),t.canEdit||t.canDelete||u.$slots["row-actions"]?(c(),f("td",Fe,[o("div",Ae,[$(u.$slots,"row-actions",{row:b}),t.canEdit?(c(),f("button",{key:0,class:"btn btn-lg btn-warning",onClick:_=>u.$emit("edit",b)},Re,8,Oe)):y("",!0),t.canDelete?(c(),f("button",{key:1,class:"btn btn-lg btn-danger","data-bs-toggle":"modal","data-bs-target":"#modal-delete",onClick:_=>i.value=b.id},Ne,8,Ee)):y("",!0)])])):y("",!0)])]),_:3})])]),t.canPaginate?(c(),z(oe,{key:0,"per-page":r.value,"total-rows":d.value,onChangePage:F},null,8,["per-page","total-rows"])):y("",!0)]),_:3},8,["ds-data","ds-sortby"])]),_:3},8,["title"]),o("div",{class:"modal fade",id:"modal-delete",tabindex:"-1"},[o("div",{class:"modal-dialog"},[o("div",{class:"modal-content"},[Te,je,o("div",{class:"modal-footer"},[Le,o("button",{class:"btn btn-danger","data-bs-dismiss":"modal",onClick:m},"Confirmar")])])])])])):y("",!0)],64)}}};export{Ge as _};
