import{u as M,r as c,s as j,o as q,a as z,b as i,e as o,g as m,d as t,t as r,h as p,m as E,n as S,D as J,J as L,F as $,f as U,i as H}from"./index.1de81d9c.js";import{I as K}from"./installationsApi.e762c392.js";import{S as Q}from"./SVGView.6581aa3d.js";import{D as W,_ as X}from"./SVGPanel.b74ebbde.js";import{h as A}from"./toast.1c03bdcb.js";import{f as Y}from"./formatters.fd94289a.js";import{_ as Z}from"./Loader.5f66cc62.js";const ee={class:"device-page container mt-5"},te={key:0,class:"text-center"},ae={class:"d-flex justify-content-between align-items-center mb-3"},ne={class:"me-3"},se={key:1,class:"input-group mt-3"},le={class:"pins-layout mt-4"},ie=t("h4",null,"V\xE1lvulas",-1),oe={class:"row"},re=["disabled","onClick"],ce={key:1,class:"my-4"},we={__name:"Installation",setup(ue){const D=M(),g=new K,T=new Q,B=new W,l=c(!1),a=c(null),R=c(D.query.id),G=j(()=>{var n;return(n=a.value)!=null&&n.is_online?"text-success":"text-danger"}),f=c({weight:null}),d=async(n,e)=>{l.value.loaderOn();const u=await g.execAction(a.value.id,n,e);A(u,u.data),l.value.loaderOff(),await b()},v=c(null),N=async()=>{var e;const n=await T.getOwnerSvgId("installations",a.value.id);v.value=((e=n.data)==null?void 0:e.svg_id)||null,v.value&&(await H(),_.value&&await _.value.refresh())},_=c(null),b=async()=>{l.value.loaderOn();const n=await g.get(R.value);a.value=n.data,await N(),l.value.loaderOff()},F=async n=>{l.value.loaderOn();const e=await B.togglePin(n);e.success&&(A(e,"Pino alternado com sucesso"),await b()),l.value.loaderOff()};return q(async()=>{await b()}),(n,e)=>{var w,k,h,y,C,x,V,P,I,O;const u=z("mdicon");return i(),o($,null,[m(Z,{ref_key:"loader",ref:l},null,512),t("div",ee,[t("h2",null,"Placa: "+r((w=a.value)==null?void 0:w.name),1),t("p",null,"IP: "+r((k=a.value)==null?void 0:k.ip_address),1),v.value?(i(),o("div",te,[m(X,{ref_key:"SVGPanelRef",ref:_,svgId:v.value},null,8,["svgId"])])):p("",!0),t("div",ae,[t("div",null,[t("span",ne," \xDAltimo acesso: "+r(E(Y)((h=a.value)==null?void 0:h.last_seen)||"-"),1),t("span",{class:S(G.value)},r((y=a.value)!=null&&y.is_online?"Online":"Offline"),3)]),t("div",null,[t("button",{class:"btn btn-info btn-lg me-2",title:"Verificar conex\xE3o",onClick:e[0]||(e[0]=s=>d("healthcheck"))},[m(u,{name:"check"})]),t("button",{class:"btn btn-warning btn-lg me-2",title:"Reiniciar dispositivo",onClick:e[1]||(e[1]=s=>d("restart"))},[m(u,{name:"restart"})]),((C=a.value)==null?void 0:C.hardware_kind)==="input"?(i(),o("button",{key:0,class:"btn btn-primary btn-lg me-2",title:"Tarar balan\xE7a",onClick:e[2]||(e[2]=s=>d("tare"))}," Tarar ")):p("",!0),((x=a.value)==null?void 0:x.hardware_kind)==="input"?(i(),o("div",se,[J(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>f.value.weight=s),type:"number",step:"0.01",class:"form-control",placeholder:"Peso"},null,512),[[L,f.value.weight]]),t("button",{class:"input-group-text btn-primary",onClick:e[4]||(e[4]=s=>d("calibrate",f.value))},"Calibrar")])):p("",!0)])]),t("div",le,[ie,t("div",oe,[(i(!0),o($,null,U((V=a.value)==null?void 0:V.pins,s=>(i(),o("div",{key:s.id,class:"col-6 col-md-2 mb-3 text-center position-relative"},[t("button",{class:S(["btn w-100 position-relative",s.is_active?"btn-success":"btn-danger"]),disabled:a.value.hardware_kind==="input",onClick:de=>F(s.id)},r(s.name),11,re)]))),128))])]),((P=a.value)==null?void 0:P.hardware_kind)==="output"?(i(),o("div",ce,[t("small",null," Valor bin\xE1rio: "+r((I=a.value)==null?void 0:I.binary_value)+" | Valor decimal: "+r((O=a.value)==null?void 0:O.decimal_value),1)])):p("",!0)])],64)}}};export{we as default};
