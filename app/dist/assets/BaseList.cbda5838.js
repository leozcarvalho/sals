import{r as w,s as k,b as c,e as v,d as i,n as I,F as R,f as E,t as N,k as L,v as p,x as D,y as O,c as q,w as T,h as y,z as H,i as J,B as Q,o as U,a as M,m as j,C as W,g as B,D as Y,E as Z,G as K}from"./index.4aae8c21.js";import{h as X}from"./toast.a6367562.js";const ee={class:"d-flex flex-md-row flex-column justify-content-center align-items-center mt-5"},te={"aria-label":"Page navigation example"},se={class:"pagination"},ae=["onClick"],ne={__name:"Paginator",props:{perPage:{type:Number,default:10,description:"Items per page"},totalRows:{type:Number,default:50,description:"Total items"}},setup(t,{emit:l}){const s=t,e=w(1),n=k(()=>parseInt(Math.ceil(s.totalRows/s.perPage))),a=d=>{d>=1&&d<=n.value&&(e.value=d,l("changePage",d))},r=k(()=>Math.max(1,e.value-2)),u=k(()=>Math.min(n.value,e.value+2)),_=k(()=>{const d=[];for(let m=r.value;m<=u.value;m++)d.push(m);return r.value>2&&d.unshift("..."),r.value>1&&d.unshift(1),u.value<n.value-1&&d.push("..."),u.value<n.value&&d.push(n.value),d});return(d,m)=>(c(),v("div",ee,[i("nav",te,[i("ul",se,[i("li",{class:I(["page-item",{disabled:e.value<=1}])},[i("a",{class:"page-link",onClick:m[0]||(m[0]=g=>a(e.value-1))},"Anterior")],2),(c(!0),v(R,null,E(_.value,g=>(c(),v("li",{key:g,class:I(["page-item",{active:g===e.value,disabled:g==="..."}])},[i("a",{class:"page-link",onClick:x=>g!=="..."&&a(g)},N(g),9,ae)],2))),128)),i("li",{class:I(["page-item",{disabled:e.value>=n.value}])},[i("a",{class:"page-link",onClick:m[1]||(m[1]=g=>a(e.value+1))},"Pr\xF3xima")],2)])])]))}},le={show:"Show",entries:"entries",previous:"Previous",next:"Next",showing:"Showing",showingTo:"to",showingOf:"of",showingEntries:"entries"},oe="...";function V(t){for(const l in t)return!1;return!0}function re(t,l){const s=[],e=[];let n;if(s.push(1),t<=1)return s;for(let a=l-2;a<=l+2;a++)a<t&&a>1&&s.push(a);s.push(t);for(let a=0;a<s.length;a++)n&&(s[a]-n===2?e.push(n+1):s[a]-n!==1&&e.push(oe)),e.push(s[a]),n=s[a];return e}function ie(t,l={}){const s=[];let e;const n=t.length;return t=t.map(function(a,r){return a[0]==="-"?(s[r]=-1,a=a.substring(1)):s[r]=1,a}),function(a,r){for(e=0;e<n;e++){const u=t[e],_=l[u]?l[u](a.value[u]):a.value[u],d=l[u]?l[u](r.value[u]):r.value[u];if(_>d)return s[e];if(_<d)return-s[e]}return 0}}function de(t,l){for(const s in l)t=t.filter(function(e){const n=e.value;for(const a in n)if(a===s){if(typeof l[s]=="function")return l[s](n[a]);if(l[s]===""||n[a]===l[s])return!0}return!1});return t}function ue(t,l,s,e){e=String(e).toLowerCase();for(const n in s)if(t.length===0||t.indexOf(n)!==-1){const a=String(s[n]).toLowerCase();for(const r in l)if(r===n&&typeof l[r]=="function"){const u=l[r](a,e,s);if(u===!0)return u}if(a.indexOf(e)>=0)return!0}return!1}const z=(t,l)=>{const s=t.__vccOpts||t;for(const[e,n]of l)s[e]=n;return s},ce={props:{dsData:{type:Array,default:()=>[]},dsFilterFields:{type:Object,default:()=>({})},dsSortby:{type:Array,default:()=>[]},dsSearchIn:{type:Array,default:()=>[]},dsSearchAs:{type:Object,default:()=>({})},dsSortAs:{type:Object,default:()=>({})}},emits:["update:dsData"],setup(t,{emit:l}){const s=w(1),e=w(""),n=w(10),a=w(le),r=w([]),u=f=>{e.value=f},_=async f=>{n.value=f,await J(),s.value>$.value&&d(g.value[g.value.length-1])},d=f=>{s.value=f},m=k(()=>r.value.slice(F.value,A.value)),g=k(()=>re($.value,s.value)),x=k(()=>r.value.length),$=k(()=>Math.ceil(x.value/n.value)),F=k(()=>(s.value-1)*n.value),A=k(()=>s.value*n.value);return L(x,(f,o)=>{d(1)}),L(()=>[t.dsData,e,t.dsSortby,t.dsFilterFields,t.dsSearchIn,t.dsSearchAs,t.dsSortAs],()=>{let f=[];!e.value&&!t.dsSortby.length&&V(t.dsFilterFields)?f=t.dsData.map((o,h)=>h):(f=t.dsData.map((o,h)=>({index:h,value:o})),V(t.dsFilterFields)||(f=de(f,t.dsFilterFields)),e.value&&(f=f.filter(o=>ue(t.dsSearchIn,t.dsSearchAs,o.value,e.value))),t.dsSortby.length&&f.sort(ie(t.dsSortby,t.dsSortAs)),f=f.map(o=>o.index)),r.value=f,l("update:dsData",f.map(o=>t.dsData[o]))},{immediate:!0,deep:!0}),p("dsIndexes",r),p("search",u),p("showEntries",_),p("setActive",d),p("datasetI18n",a),p("dsData",k(()=>t.dsData)),p("dsRows",m),p("dsPages",g),p("dsResultsNumber",x),p("dsPagecount",$),p("dsFrom",F),p("dsTo",A),p("dsPage",s),{dsIndexes:r,dsShowEntries:n,dsResultsNumber:x,dsPage:s,dsPagecount:$,dsFrom:F,dsTo:A,dsRows:m,dsPages:g,search:u,showEntries:_,setActive:d}}};function fe(t,l,s,e,n,a){return D(t.$slots,"default",{ds:{dsIndexes:e.dsIndexes,dsShowEntries:e.dsShowEntries,dsResultsNumber:e.dsResultsNumber,dsPage:e.dsPage,dsPagecount:e.dsPagecount,dsFrom:e.dsFrom,dsTo:e.dsTo,dsData:s.dsData,dsRows:e.dsRows,dsPages:e.dsPages,search:e.search,showEntries:e.showEntries,setActive:e.setActive}})}const ve=z(ce,[["render",fe]]),me={props:{tag:{type:String,default:"div"}},setup(){const t=k(()=>{const l=[];for(let s=O("dsFrom").value;s<O("dsTo").value;s++)l.push(s);return l});return{dsData:O("dsData"),dsRows:O("dsRows"),indexes:t}}};function ge(t,l,s,e,n,a){return c(),q(H(s.tag),null,{default:T(()=>[(c(!0),v(R,null,E(e.dsRows,(r,u)=>D(t.$slots,"default",{row:e.dsData[r],rowIndex:r,index:e.indexes[u]})),256)),e.dsRows.length?y("",!0):D(t.$slots,"noDataFound",{key:0})]),_:3})}const he=z(me,[["render",ge]]),pe={key:0,class:"content"},be={class:"d-flex justify-content-between mb-2"},ye=["value"],ke=i("i",{class:"fa fa-plus"},null,-1),we=[ke],_e={key:0,class:"mb-3"},Pe={class:"table-responsive"},xe={class:"table table-striped"},Se=["onClick"],Ce={key:0},De={key:0},$e={class:"btn-group"},Fe=["onClick"],Ae=i("i",{class:"fa fa-pencil"},null,-1),Be=[Ae],Re=["onClick"],Ee=i("i",{class:"fa fa-trash"},null,-1),Oe=[Ee],Ie=i("div",{class:"modal-header"},"Confirmar A\xE7\xE3o",-1),Ne=i("div",{class:"modal-body"},"Deseja realmente excluir este item?",-1),Te=i("button",{class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancelar",-1),Ve={__name:"BaseList",props:{api:{type:Object,required:!0},formPath:{type:String,default:""},cols:{type:Array,required:!0},title:{type:String,default:"Lista"},canCreate:{type:Boolean,default:!0},canEdit:{type:Boolean,default:!0},canDelete:{type:Boolean,default:!0},exportable:{type:Boolean,default:!1},canFilter:{type:Boolean,default:!1},filter:{type:Object,default:{}},canPaginate:{type:Boolean,default:!1},permission:{type:String,default:null}},emits:["update:filter","create","edit"],setup(t,{expose:l,emit:s}){const e=t,n=w([]),a=w(0),r=w(e.filter.limit||10),u=w([5,10,25,50,100]),_=w(null),d=w(!1);Q();const m=async()=>{var h,S;const o=await e.api.getList(e.filter);n.value=o.data.items||((h=o.data.data)==null?void 0:h.items)||[],a.value=o.data.count||((S=o.data.data)==null?void 0:S.count)||0};l({refresh:m});const g=()=>{d.value=!d.value},x=o=>{!e.filter||(e.filter.skip=r.value*(o-1),s("update:filter",e.filter),m())},$=()=>{!e.filter||(e.filter.limit=r.value,e.filter.skip=0,s("update:filter",e.filter),m())},F=o=>{e.filter.sort_by=e.cols[o].field,e.filter.order_desc=!e.filter.order_desc,e.cols.forEach((h,S)=>{h.sort=S===o?e.filter.order_desc?"desc":"asc":""}),s("update:filter",e.filter),m()},A=async()=>{if(!_.value)return;const o=await e.api.delete(_.value);X(o,"Item exclu\xEDdo com sucesso"),m()},f=async()=>{!e.exportable||await e.api.export(e.filter)};return U(()=>{m()}),(o,h)=>{const S=M("mdicon"),G=M("BaseBlock");return e.permission===null||j(W)(e.permission)?(c(),v("div",pe,[B(G,{title:t.title,"content-full":""},{default:T(()=>[i("div",be,[i("div",null,[t.canFilter?(c(),v("button",{key:0,class:"btn btn-lg btn-primary",onClick:g},[B(S,{name:"filter"})])):y("",!0),t.canPaginate?Y((c(),v("select",{key:1,"onUpdate:modelValue":h[0]||(h[0]=C=>r.value=C),onChange:$,class:"form-select d-inline w-auto ms-2"},[(c(!0),v(R,null,E(u.value,C=>(c(),v("option",{key:C,value:C},N(C),9,ye))),128))],544)),[[Z,r.value]]):y("",!0)]),i("div",null,[D(o.$slots,"extra-actions"),t.canCreate?(c(),v("button",{key:0,class:"btn btn-lg btn-success",onClick:h[1]||(h[1]=C=>o.$emit("create"))},we)):y("",!0),t.exportable?(c(),v("button",{key:1,class:"btn btn-lg btn-success ms-2",onClick:f},[B(S,{name:"file-excel"})])):y("",!0)])]),d.value?(c(),v("div",_e,[D(o.$slots,"filter")])):y("",!0),B(j(ve),{"ds-data":n.value,"ds-sortby":e.filter.sort_by?[e.filter.sort_by]:[]},{default:T(({ds:C})=>[i("div",Pe,[i("table",xe,[i("thead",null,[i("tr",null,[(c(!0),v(R,null,E(t.cols,(b,P)=>(c(),v("th",{key:b.field,class:I(["sort",b.sort]),onClick:je=>F(P)},N(b.name),11,Se))),128)),t.canEdit||t.canDelete||o.$slots["row-actions"]?(c(),v("th",Ce,"A\xE7\xF5es")):y("",!0)])]),B(j(he),{tag:"tbody",class:"fs-sm"},{default:T(({row:b})=>[i("tr",null,[(c(!0),v(R,null,E(t.cols,P=>(c(),v("td",{key:P.field},[D(o.$slots,`cell-${P.field}`,{row:b,value:b[P.field]},()=>[K(N(P.formatter?P.formatter(b[P.field],b):b[P.field]),1)])]))),128)),t.canEdit||t.canDelete||o.$slots["row-actions"]?(c(),v("td",De,[i("div",$e,[D(o.$slots,"row-actions",{row:b}),t.canEdit?(c(),v("button",{key:0,class:"btn btn-lg btn-warning",onClick:P=>o.$emit("edit",b)},Be,8,Fe)):y("",!0),t.canDelete?(c(),v("button",{key:1,class:"btn btn-lg btn-danger","data-bs-toggle":"modal","data-bs-target":"#modal-delete",onClick:P=>_.value=b.id},Oe,8,Re)):y("",!0)])])):y("",!0)])]),_:3})])]),t.canPaginate?(c(),q(ne,{key:0,"per-page":r.value,"total-rows":a.value,onChangePage:x},null,8,["per-page","total-rows"])):y("",!0)]),_:3},8,["ds-data","ds-sortby"])]),_:3},8,["title"]),i("div",{class:"modal fade",id:"modal-delete",tabindex:"-1"},[i("div",{class:"modal-dialog"},[i("div",{class:"modal-content"},[Ie,Ne,i("div",{class:"modal-footer"},[Te,i("button",{class:"btn btn-danger","data-bs-dismiss":"modal",onClick:A},"Confirmar")])])])])])):y("",!0)}}};export{Ve as _};
